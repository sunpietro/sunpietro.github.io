/*!
 * Dragster - drag'n'drop library v1.0.0
 * https://github.com/sunpietro/dragster
 *
 * Copyright 2015 Piotr Nalepa
 * http://blog.piotrnalepa.pl
 *
 * Released under the MIT license
 * https://github.com/sunpietro/dragster/blob/master/LICENSE
 *
 * Date: 2015-03-21T18:50Z
 */
(function(e,t){e.DD=function(e){var n="is-dragging",o="is-drag-over",r="dragster-draggable",s="dragster-drag-region",i="dragster-drop-placeholder",a="dragster-temp",l="dragster-is-hidden",c={elementSelector:".dragster-block",regionSelector:".dragster-region"},d="draggable",u="data-placeholder-position",f={top:false,bottom:false},m,p,v,h,g,L,y,E,b,w,A,C,S,T,q,B,N,x,D;for(m in e){if(e.hasOwnProperty(m)){c[m]=e[m]}}y=Array.prototype.slice.call(t.querySelectorAll(c.elementSelector));p=Array.prototype.slice.call(t.querySelectorAll(c.regionSelector));v=function(e,t){var n=e.parentNode;if(!n||e.classList&&e.classList.contains(s)){return undefined}if(t(e)){return e}return t(n)?n:v(n,t)};x=function(e){var n=Array.prototype.slice.call(t.querySelectorAll(e));n.forEach(function(e){e.parentNode.removeChild(e)})};D=function(e,o){p.forEach(function(e){e.removeEventListener(o,E.mousemove)});t.body.removeEventListener(o,E.mousemove);if(e){e.classList.remove(n)}x("."+i);x("."+a)};T=function(){var e=t.createElement("div");e.setAttribute(d,true);e.classList.add(r);return e};B=function(){var e=t.createElement("div");e.classList.add(i);return e};q=function(){var e=t.createElement("div");e.classList.add(a);e.classList.add(l);t.body.appendChild(e);return e};C=function(e,t){e.parentNode.insertBefore(t,e.nextSibling)};S=function(e,t){e.parentNode.insertBefore(t,e)};A=function(e){return e.classList&&e.classList.contains(s)};w=function(e){return e.classList&&e.classList.contains(r)};b=function(e){return e.classList&&e.classList.contains(i)};E={mousedown:function(e){e.preventDefault();var o,r=e.type==="touchstart"?"touchmove":"mousemove";p.forEach(function(e){e.addEventListener(r,E.mousemove)});t.body.addEventListener(r,E.mousemove);L=v(e.target,w);if(!L){return false}o=L.getBoundingClientRect();h=q();h.innerHTML=L.innerHTML;h.style.width=o.width+"px";h.style.height=o.height+"px";g=h.getBoundingClientRect();L.classList.add(n)},mousemove:function(e){e.preventDefault();var n=e.changedTouches?e.changedTouches[0]:e,o=t.elementFromPoint(n.clientX,n.clientY),a=v(o,w),c,d,m;clearTimeout(N);h.style.top=n.clientY+25+"px";h.style.left=n.clientX-g.width/2+"px";h.classList.remove(l);if(a&&a!==L){m=B();c=a.getBoundingClientRect();d=c.height/2;if(n.clientY-c.top<d&&!f.top){x("."+i);m.setAttribute(u,"top");S(a.firstChild,m)}else if(c.bottom-n.clientY<d&&!f.bottom){x("."+i);m.setAttribute(u,"bottom");a.appendChild(m)}}else if(o.classList.contains(s)&&o.querySelectorAll("."+r).length===0&&o.querySelectorAll("."+i).length===0){m=B();o.appendChild(m)}else{x("."+i)}},mouseup:function(e){var n=t.querySelector("."+i),r,s,a=e.type==="touchstart"?"touchmove":"mousemove",l;N=setTimeout(function(){D(L,a)},200);if(!L){return false}if(!n){D(L,a);return false}r=v(n,w);r=r||n;if(L!==r){l=T();l.innerHTML=L.innerHTML;s=n.getAttribute(u);if(s==="top"){S(r,l)}else{C(r,l)}r.classList.remove(o);L.parentNode.removeChild(L)}D(L,a)}};y.forEach(function(e){var t=T(),n=e.parentNode;n.insertBefore(t,e);n.removeChild(e);t.appendChild(e)});t.body.addEventListener("mouseup",E.mouseup,false);t.body.addEventListener("touchend",E.mouseup,false);p.forEach(function(e){e.classList.add(s);e.addEventListener("mousedown",E.mousedown,false);e.addEventListener("mouseup",E.mouseup,false);e.addEventListener("touchstart",E.mousedown,false);e.addEventListener("touchend",E.mouseup,false)})}})(window,window.document);
